<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>로그인</title>
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body class="d-flex justify-content-center align-items-center vh-100">

	<div class="card p-4 shadow" style="width: 350px;">
		<h3 class="text-center">로그인</h3>
		<div class="mb-3">
			<label for="username" class="form-label">아이디</label> <input
				type="text" id="username" class="form-control">
		</div>
		<div class="mb-3">
			<label for="password" class="form-label">비밀번호</label> <input
				type="password" id="password" class="form-control">
		</div>
		<button class="btn btn-primary w-100" onclick="login()">로그인</button>
		<p id="errorMessage" class="text-danger text-center mt-3"></p>
	</div>

	<script>
        function login() {
            let username = document.getElementById("username").value.trim();
            let password = document.getElementById("password").value.trim();
            let errorMessage = document.getElementById("errorMessage");

            // 입력값 검증 (프론트에서 빈 값 체크)
            if (!username || !password) {
                errorMessage.textContent = "아이디와 비밀번호를 입력하세요.";
                return;
            }

            axios.post("/api/login", { userId: username, userPw: password })
            .then(response => {
                console.log("로그인 성공, 토큰:", response.data.token);
                localStorage.setItem("token", response.data.token);
                window.location.href = "/";
            })
            .catch(error => {
                console.error("로그인 실패", error);

                if (error.response) {
                    let msg = error.response.data?.message || "로그인 중 오류가 발생했습니다.";

                    errorMessage.textContent = msg;
                } else {
                    errorMessage.textContent = "서버와의 연결이 원활하지 않습니다.";
                }
            });
        }
    </script>

</body>
</html>
